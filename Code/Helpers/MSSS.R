


# Define LUT --------------------------------------------------------------

MSSSs = matrix(c(
  c( 0.67,  2.44,  4.30, 	5.87, 	7.08, 	7.93,  8.64, 	9.09,  9.35,  9.50,  9.63, 	9.74,  9.84,  9.90,  9.94, 	9.97,  9.98,  9.98,  9.99),
  c( 0.53,  2.01,  3.69, 	5.24, 	6.46, 	7.27,  7.98, 	8.58,  8.95,  9.18,  9.38, 	9.59,  9.79,  9.88,  9.93, 	9.97,  9.99,  9.99,  9.99),
  c( 0.45,  1.77,  3.34, 	4.82, 	6.00, 	6.81,  7.54, 	8.14,  8.55,  8.83,  9.07, 	9.35,  9.63,  9.77,  9.86, 	9.92,  9.97,  9.98,  9.99),
  c( 0.35,  1.45,  2.87, 	4.27, 	5.41, 	6.24,  6.98, 	7.65,  8.12,  8.42,  8.70, 	9.08,  9.47,  9.68,  9.80, 	9.88,  9.95,  9.98,  9.99),
  c( 0.30,  1.28,  2.60, 	3.90, 	4.95, 	5.79,  6.58, 	7.26,  7.75,  8.08,  8.38, 	8.83,  9.32,  9.60,  9.76, 	9.86,  9.95,  9.98,  9.99),
  c( 0.25,  1.13,  2.33, 	3.54, 	4.55, 	5.38,  6.14, 	6.81,  7.33,  7.66,  7.98, 	8.50,  9.08,  9.45,  9.68, 	9.81,  9.93,  9.97,  9.99),
  c( 0.24,  1.04,  2.10, 	3.17, 	4.13, 	4.96,  5.75, 	6.46,  6.98,  7.32,  7.65, 	8.24,  8.91,  9.33,  9.59, 	9.76,  9.90,  9.95,  9.99),
  c( 0.21,  0.94,  1.92, 	2.93, 	3.81, 	4.57,  5.36, 	6.10,  6.61,  6.95,  7.32, 	7.97,  8.71,  9.21,  9.55, 	9.74,  9.89,  9.96,  9.99),
  c( 0.21,  0.88,  1.76, 	2.65, 	3.45, 	4.17,  4.93, 	5.64,  6.14,  6.50,  6.90, 	7.65,  8.53,  9.09,  9.47, 	9.70,  9.87,  9.95,  9.99),
  c( 0.19,  0.78,  1.53, 	2.34, 	3.10, 	3.79,  4.55, 	5.28,  5.77,  6.14,  6.58, 	7.39,  8.31,  8.92,  9.34, 	9.61,  9.83,  9.94,  9.99),
  c( 0.17,  0.71,  1.40, 	2.13, 	2.82, 	3.46,  4.21, 	4.94,  5.42,  5.82,  6.30, 	7.18,  8.15,  8.79,  9.24, 	9.52,  9.78,  9.92,  9.98),
  c( 0.16,  0.64,  1.28, 	1.98, 	2.64, 	3.25,  3.94, 	4.63,  5.13,  5.54,  6.03, 	6.92,  7.93,  8.63,  9.13, 	9.43,  9.71,  9.88,  9.97),
  c( 0.13,  0.57,  1.14, 	1.80, 	2.44, 	3.05,  3.70, 	4.38,  4.91,  5.32,  5.80, 	6.74,  7.83,  8.55,  9.03, 	9.34,  9.65,  9.85,  9.96),
  c( 0.11,  0.49,  1.03, 	1.70, 	2.33, 	2.91,  3.55, 	4.26,  4.82,  5.23,  5.70, 	6.56,  7.59,  8.34,  8.86, 	9.20,  9.57,  9.82,  9.95),
  c( 0.10,  0.45,  0.99, 	1.64, 	2.26, 	2.82,  3.44, 	4.14,  4.68,  5.09,  5.51, 	6.33,  7.41,  8.17,  8.70, 	9.11,  9.51,  9.78,  9.94),
  c( 0.09,  0.38,  0.85, 	1.42, 	1.99, 	2.56,  3.17, 	3.86,  4.41,  4.81,  5.18, 	6.00,  7.14,  7.97,  8.54, 	9.04,  9.49,  9.75,  9.94),
  c( 0.05,  0.32,  0.76, 	1.28, 	1.77, 	2.30,  2.95, 	3.65,  4.17,  4.55,  4.94, 	5.74,  6.89,  7.77,  8.38, 	8.99,  9.52,  9.79,  9.96),
  c( 0.04,  0.26,  0.66, 	1.12, 	1.57, 	2.09,  2.70, 	3.37,  3.89,  4.27,  4.62, 	5.43,  6.62,  7.54,  8.23, 	8.94,  9.51,  9.78,  9.96),
  c( 0.05,  0.28,  0.63, 	1.00, 	1.39, 	1.89,  2.50, 	3.19,  3.72,  4.12,  4.49, 	5.35,  6.59,  7.51,  8.22, 	8.98,  9.57,  9.81,  9.96),
  c( 0.05,  0.26,  0.59, 	0.94, 	1.29, 	1.71,  2.29, 	2.99,  3.51,  3.93,  4.30, 	5.15,  6.43,  7.45,  8.23, 	8.98,  9.58,  9.80,  9.95),
  c( 0.05,  0.30,  0.66, 	1.02, 	1.39, 	1.77,  2.34, 	2.97,  3.43,  3.83,  4.21, 	5.09,  6.35,  7.33,  8.08, 	8.87,  9.49,  9.77,  9.96),
  c( 0.04,  0.23,  0.54, 	0.90, 	1.28, 	1.66,  2.20, 	2.82,  3.29,  3.69,  4.09, 	5.04,  6.35,  7.35,  8.10, 	8.84,  9.42,  9.73,  9.95),
  c( 0.05,  0.27,  0.58, 	0.91, 	1.26, 	1.64,  2.19, 	2.78,  3.21,  3.69,  4.19, 	5.16,  6.47,  7.46,  8.20, 	8.87,  9.43,  9.75,  9.95),
  c( 0.05,  0.24,  0.52, 	0.86, 	1.25, 	1.63,  2.15, 	2.71,  3.09,  3.52,  4.01, 	5.03,  6.36,  7.38,  8.15, 	8.81,  9.39,  9.74,  9.96),
  c( 0.05,  0.23,  0.47, 	0.77, 	1.15, 	1.56,  2.05, 	2.53,  2.84,  3.21,  3.74, 	4.88,  6.26,  7.24,  8.00, 	8.73,  9.35,  9.75,  9.98),
  c( 0.05,  0.20,  0.45, 	0.78, 	1.17, 	1.58,  2.08, 	2.63,  2.99,  3.40,  3.95, 	5.02,  6.39,  7.44,  8.21, 	8.89,  9.48,  9.80,  9.96),
  c( 0.05,  0.22,  0.48, 	0.78, 	1.15, 	1.56,  2.03, 	2.56,  2.91,  3.29,  3.86, 	4.93,  6.33,  7.38,  8.14, 	8.91,  9.56,  9.85,  9.98),
  c( 0.04,  0.17,  0.40, 	0.74, 	1.16, 	1.52,  1.88, 	2.39,  2.76,  3.04,  3.46, 	4.54,  5.99,  7.07,  7.90, 	8.75,  9.45,  9.80,  9.98),
  c( 0.03,  0.18,  0.47, 	0.80, 	1.19, 	1.51,  1.79, 	2.27,  2.68,  3.01,  3.41, 	4.35,  5.68,  6.76,  7.66, 	8.62,  9.38,  9.75,  9.96),
  c( 0.01,  0.13,  0.45, 	0.82, 	1.19, 	1.45,  1.69, 	2.23,  2.75,  3.13,  3.50, 	4.35,  5.61,  6.66,  7.54, 	8.47,  9.27,  9.67,  9.91)
), nrow = 30, byrow = TRUE)

dimnames(MSSSs) <- list(1:30,
                        c(0, seq(1, 9.5, 0.5)))


# Define function ---------------------------------------------------------

getMSSS <- function(dd, edss) {
  dd <- pmax(pmin(dd, 30), 1)
  edss <- pmin(edss, 9.5)
  mapply(function(ddi, edssi) tryCatch(MSSSs[ddi, edssi], error = function(e) {NA}), 
         as.character(dd), as.character(edss))
}


# test --------------------------------------------------------------------

getMSSS(c(1,2,3),c(2,2.5,2.5))
getMSSS(c(1,2,3),c(2,2.5,2.4))
